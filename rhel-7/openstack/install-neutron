pwd
yum install -y `cat packages01`
yum install -y `cat packages02 | grep -v ceph`

yum install -y `cat packages-neutron`;
cp /etc/neutron/neutron.conf /etc/neutron/neutron.conf.save.`date +%d.%m.%y-%H.%M`

openstack-config --set  /etc/neutron/neutron.conf database connection mysql://neutron:$NEUTRON_DBPASS@$CONTROLLER/neutron
openstack-config --set  /etc/neutron/neutron.conf DEFAULT rpc_backend rabbit
openstack-config --set  /etc/neutron/neutron.conf DEFAULT auth_strategy keystone
openstack-config --set  /etc/neutron/neutron.conf DEFAULT core_plugin ml2
openstack-config --set  /etc/neutron/neutron.conf DEFAULT service_plugins router
openstack-config --set  /etc/neutron/neutron.conf DEFAULT allow_overlapping_ips True
openstack-config --set  /etc/neutron/neutron.conf DEFAULT verbose True
openstack-config --set  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_status_changes True
openstack-config --set  /etc/neutron/neutron.conf DEFAULT notify_nova_on_port_data_changes True
openstack-config --set  /etc/neutron/neutron.conf DEFAULT nova_url http://$CONTROLLER:8774/v2
openstack-config --set  /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_host $HOSTNAME
openstack-config --set  /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_userid openstack
openstack-config --set  /etc/neutron/neutron.conf oslo_messaging_rabbit rabbit_password $RABBIT_PASS

openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken auth_uri http://$CONTROLLER:5000
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken auth_url http://$CONTROLLER:35357
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken auth_plugin password
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken project_domain_id default
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken user_domain_id default
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken project_name service
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken username neutron
openstack-config --set  /etc/neutron/neutron.conf keystone_authtoken password $NEUTRON_PASS

openstack-config --set  /etc/neutron/neutron.conf nova  auth_url  http://$CONTROLLER:35357
openstack-config --set  /etc/neutron/neutron.conf nova  auth_plugin  password
openstack-config --set  /etc/neutron/neutron.conf nova  project_domain_id  default
openstack-config --set  /etc/neutron/neutron.conf nova  user_domain_id  default
openstack-config --set  /etc/neutron/neutron.conf nova  region_name  RegionOne
openstack-config --set  /etc/neutron/neutron.conf nova  project_name  service
openstack-config --set  /etc/neutron/neutron.conf nova  username  nova
openstack-config --set  /etc/neutron/neutron.conf nova  password  $NOVA_PASS


openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini ml2 type_drivers flat,vlan,gre,vxlan
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini ml2 tenant_network_types gre
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini ml2 mechanism_drivers openvswitch
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini ml2_type_gre tunnel_id_ranges 1:1000
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_security_group True
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup enable_ipset True
openstack-config --set  /etc/neutron/plugins/ml2/ml2_conf.ini securitygroup firewall_driver neutron.agent.linux.iptables_firewall.OVSHybridIptablesFirewallDriver

